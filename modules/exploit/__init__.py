from rtfmapi.modules.exploit.cve import *
import hug

@hug.post('/shellshock/query/possible', output=hug.output_format.json)
def shellshock_possible_api(uid, secret):
    from rtfmapi.modules.exploit.cve.cve_2014_6271.query_shellshock import ShellShock
    '''Gets vulnerable URLs'''
    if uid == None or secret == None:
        ss = ShellShock()
    else:
        ss = ShellShock(uid, secret)
    return list(ss.get_results())
